<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>EARN PRO MAX</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <script src='//libtl.com/sdk.js' data-zone='10318378' data-sdk='show_10318378'></script>
    <script type="text/javascript" src="https://pl28272285.effectivegatecpm.com/79/ca/d6/79cad6252204e9c90dd50644a69e75f9.js"></script>

    <style>
        :root { --neon: #00f0ff; --glass: rgba(255, 255, 255, 0.08); }
        body { background: #0b0f19; color: white; font-family: sans-serif; margin: 0; padding: 15px; overflow-x: hidden; }
        .header { display: flex; justify-content: space-between; align-items: center; }
        .social-icons a { font-size: 20px; color: white; margin-right: 12px; }
        
        #notice { position: fixed; top: -100px; left: 50%; transform: translateX(-50%); background: #ffcc00; color: #000; padding: 12px; border-radius: 10px; font-weight: bold; width: 85%; transition: 0.6s; z-index: 10000; text-align: center; box-shadow: 0 5px 15px rgba(0,0,0,0.5); }
        
        .orb { width: 140px; height: 140px; border-radius: 50%; background: radial-gradient(circle, #1a2236, #000); border: 3px solid var(--neon); box-shadow: 0 0 20px var(--neon); margin: 20px auto; display: flex; flex-direction: column; justify-content: center; align-items: center; }
        .bal-val { font-size: 38px; font-weight: bold; color: var(--neon); }

        .stat-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 15px 0; }
        .s-box { background: var(--glass); padding: 10px; border-radius: 10px; text-align: center; border: 1px solid rgba(255,255,255,0.1); }
        .s-box b { color: var(--neon); display: block; font-size: 18px; }

        .btn-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .btn { background: var(--glass); border: 1px solid rgba(255,255,255,0.1); padding: 15px; border-radius: 12px; color: white; cursor: pointer; display: flex; flex-direction: column; align-items: center; font-weight: bold; }
        .btn-full { grid-column: span 2; background: linear-gradient(90deg, #00f0ff, #0072ff); color: #000; border: none; }
        .btn:disabled { opacity: 0.3; }

        #toast { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); background: var(--neon); color: #000; padding: 8px 20px; border-radius: 20px; font-weight: bold; display: none; }
    </style>
</head>
<body>

    <div id="notice">ðŸ”” Loading Update...</div>

    <div class="header">
        <div class="social-icons">
            <a href="https://www.facebook.com/share/1Lxkm78smE/"><i class="fab fa-facebook"></i></a>
            <a href="https://t.me/ratulhossain56"><i class="fab fa-telegram"></i></a>
            <a href="https://youtube.com/@alex-42-41?si=TZsqZNj0Gey4g5rq"><i class="fab fa-youtube"></i></a>
        </div>
        <div id="uName" style="font-size: 14px;">User</div>
    </div>

    <div class="orb">
        <div class="bal-val" id="balance">0</div>
        <small>POINTS</small>
    </div>

    <div class="stat-grid">
        <div class="s-box"><small>Monetag Daily</small><b id="dMonetag">00/20</b></div>
        <div class="s-box"><small>Total Ad Count</small><b id="tMonetag">0</b></div>
        <div class="s-box" style="grid-column: span 2;"><small>Adsterra Task</small><b id="dAdsterra">00/10</b></div>
    </div>

    <div class="btn-grid">
        <button class="btn" id="mBtn" onclick="watchMonetag()"><i class="fas fa-play"></i> MONETAG <span id="mT"></span></button>
        <button class="btn" id="aBtn" onclick="watchAdsterra()"><i class="fas fa-tasks"></i> DAILY TASK <span id="aT"></span></button>
        <button class="btn" onclick="copy('refer')"><i class="fas fa-users"></i> REFER (+1 PT)</button>
        <button class="btn" onclick="openCashout()"><i class="fas fa-wallet"></i> CASHOUT</button>
        <button class="btn btn-full" onclick="copy('monetag')"><i class="fas fa-link"></i> SHARE MONETAG LINK</button>
        <button class="btn btn-full" style="background:#ff4757; color:white;" onclick="copy('adsterra')"><i class="fas fa-link"></i> SHARE ADSTERRA LINK</button>
    </div>

    <div id="toast"></div>

    <script>
        const tg = window.Telegram.WebApp;
        const userId = String(tg.initDataUnsafe?.user?.id || "dev_user");
        const BACKEND = "https://monetagads4241r.onrender.com";

        firebase.initializeApp({
            apiKey: "AIzaSyBHgVkLJu7ROlQYcvx7sxDJjEJymZkXEdE",
            authDomain: "monetas-ads-4241.firebaseapp.com",
            projectId: "monetas-ads-4241",
            storageBucket: "monetas-ads-4241.firebasestorage.app",
            messagingSenderId: "482009819786",
            appId: "1:482009819786:web:8606ae48b666bfd9a1db73"
        });
        const db = firebase.firestore();
        let uData = {};

        db.collection('users').doc(userId).onSnapshot(doc => {
            if(!doc.exists) return;
            uData = doc.data();
            document.getElementById('balance').innerText = uData.balance;
            document.getElementById('dMonetag').innerText = `${uData.dailyMonetag}/20`;
            document.getElementById('tMonetag').innerText = uData.totalMonetag;
            document.getElementById('dAdsterra').innerText = `${uData.dailyAdsterra}/10`;
            updateTimers();
        });

        function updateTimers() {
            const now = Date.now();
            const mRem = 300 - Math.floor((now - (uData.lastMonetagTime || 0))/1000);
            const aRem = 1200 - Math.floor((now - (uData.lastAdsterraTime || 0))/1000);
            
            const mBtn = document.getElementById('mBtn');
            if(mRem > 0 && uData.dailyMonetag < 20) { mBtn.disabled = true; document.getElementById('mT').innerText = `(${mRem}s)`; }
            else if(uData.dailyMonetag >= 20) { mBtn.disabled = true; document.getElementById('mT').innerText = "(Full)"; }
            else { mBtn.disabled = false; document.getElementById('mT').innerText = ""; }

            const aBtn = document.getElementById('aBtn');
            if(aRem > 0 && uData.dailyAdsterra < 10) { aBtn.disabled = true; document.getElementById('aT').innerText = `(${Math.ceil(aRem/60)}m)`; }
            else if(uData.dailyAdsterra >= 10) { aBtn.disabled = true; document.getElementById('aT').innerText = "(Full)"; }
            else { aBtn.disabled = false; document.getElementById('aT').innerText = ""; }
        }
        setInterval(updateTimers, 1000);

        function showNotice(msg) {
            const n = document.getElementById('notice');
            n.innerText = msg; n.style.top = "20px";
            setTimeout(() => n.style.top = "-100px", 8000);
        }
        setInterval(() => showNotice("ðŸ“¢ à¦¨à¦¿à§Ÿà¦®à¦¿à¦¤ à¦•à¦¾à¦œ à¦•à¦°à§à¦¨ à¦à¦¬à¦‚ à¦ªà§à¦°à¦¤à¦¿à¦Ÿà¦¿ à¦°à§‡à¦«à¦¾à¦°à§‡ à§§ à¦ªà§Ÿà§‡à¦¨à§à¦Ÿ à¦œà¦¿à¦¤à§‡ à¦¨à¦¿à¦¨!"), 600000);

        function watchMonetag() {
            if(window.show_10318378) show_10318378({ ymid: userId }).then(() => toast("Ad Completed!"));
        }

        function watchAdsterra() {
            window.open("https://www.effectivegatecpm.com/e0xpfuhe?key=fb81fa455f0ff2d6a8fa09ce5d18dd57", "_blank");
            db.collection('users').doc(userId).update({ dailyAdsterra: firebase.firestore.FieldValue.increment(1), lastAdsterraTime: Date.now() });
        }

        function copy(type) {
            let l = "";
            if(type==='refer') l = `https://t.me/realldoler87ok_bot?start=${userId}`;
            else if(type==='monetag') l = "https://otieu.com/4/10315373";
            else l = "https://www.effectivegatecpm.com/e0xpfuhe?key=fb81fa455f0ff2d6a8fa09ce5d18dd57";
            navigator.clipboard.writeText(l); toast("Link Copied!");
        }

        function toast(m) { const t = document.getElementById('toast'); t.innerText = m; t.style.display='block'; setTimeout(()=>t.style.display='none', 2500); }
        
        fetch(`${BACKEND}/api/sync`, { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({ userId, name: tg.initDataUnsafe?.user?.first_name, startParam: tg.initDataUnsafe?.start_param }) });
        document.getElementById('uName').innerText = tg.initDataUnsafe?.user?.first_name || "User";
    </script>
</body>
            </html>
