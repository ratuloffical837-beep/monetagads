<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Neon Master Pro</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/blueimp-md5/2.19.0/js/md5.min.js"></script>
    <script src='//libtl.com/sdk.js' data-zone='10318378' data-sdk='show_10318378'></script>
    <style>
        :root { --bg: #0b1426; --neon: #00f0ff; --glass: rgba(255, 255, 255, 0.08); }
        body { margin: 0; padding: 15px; background: var(--bg); color: #fff; font-family: sans-serif; display: flex; flex-direction: column; align-items: center; overflow-x: hidden; }
        .header { width: 100%; display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .social-btns { display: flex; gap: 5px; flex-wrap: wrap; max-width: 75%; }
        .s-btn { width: 32px; height: 32px; border: 1px solid var(--neon); border-radius: 8px; background: var(--glass); color: #fff; display: grid; place-items: center; cursor: pointer; font-size: 14px; }
        .notice-container { width: 100%; background: rgba(0,0,0,0.3); color: #00ffcc; font-size: 13px; padding: 8px 0; margin-bottom: 10px; border-top: 1px solid var(--neon); border-bottom: 1px solid var(--neon); overflow: hidden; }
        .orb { width: 110px; height: 110px; border-radius: 50%; border: 3px solid var(--neon); box-shadow: 0 0 20px var(--neon); display: flex; flex-direction: column; justify-content: center; align-items: center; margin: 15px 0; background: radial-gradient(circle, rgba(0,240,255,0.1) 0%, transparent 70%); }
        .stats { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; width: 100%; margin-bottom: 15px; }
        .s-box { background: var(--glass); padding: 10px; border-radius: 12px; text-align: center; border: 1px solid rgba(255,255,255,0.1); font-size: 11px; }
        .btn-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; width: 100%; }
        .btn { padding: 12px 5px; border-radius: 10px; border: 1px solid var(--neon); background: var(--glass); color: #fff; font-weight: bold; cursor: pointer; display: flex; flex-direction: column; align-items: center; gap: 5px; font-size: 11px; transition: 0.3s; }
        .btn:active { transform: scale(0.95); background: rgba(0,240,255,0.2); }
        .btn-disabled { opacity: 0.4; pointer-events: none !important; filter: grayscale(1); }
        #toast { position: fixed; bottom: 20px; background: #000; padding: 12px 25px; border-radius: 25px; visibility: hidden; border: 1px solid var(--neon); z-index: 5000; font-size: 14px; box-shadow: 0 0 15px var(--neon); }
        #wModal { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 85%; background: #111a2e; border: 2px solid var(--neon); border-radius: 20px; padding: 20px; z-index: 4000; box-shadow: 0 0 40px #000; }
        #wModal input, #wModal select { width: 100%; padding: 12px; margin-bottom: 12px; background: #0b1426; border: 1px solid var(--neon); color: #fff; border-radius: 10px; box-sizing: border-box; outline: none; }
        .section { display: none; width: 100%; height: 100vh; position: fixed; top: 0; left: 0; background: var(--bg); z-index: 3000; padding: 10px; box-sizing: border-box; }
        iframe { width: 100%; height: calc(100% - 60px); border-radius: 15px; border: 1px solid var(--neon); background: #fff; margin-top: 10px; }
    </style>
</head>
<body>
    <div id="mainSection">
        <div class="header">
            <div class="social-btns">
                <div class="s-btn" onclick="tg.openLink('https://youtube.com/@alex-42-41')"><i class="fab fa-youtube"></i></div>
                <div class="s-btn" onclick="tg.openLink('https://facebook.com/share/1UQCaxE29T/')"><i class="fab fa-facebook"></i></div>
                <div class="s-btn" onclick="tg.openLink('https://t.me/ratulhossain56')"><i class="fab fa-telegram"></i></div>
                <div class="s-btn" style="background:#ff9500" onclick="tg.openLink('https://www.effectivegatecpm.com/e0xpfuhe?key=fb81fa455f0ff2d6a8fa09ce5d18dd57')"><i class="fas fa-bolt"></i></div>
                <div class="s-btn" style="background:#28cd41" onclick="copyText('https://www.effectivegatecpm.com/e0xpfuhe?key=fb81fa455f0ff2d6a8fa09ce5d18dd57')"><i class="fas fa-copy"></i></div>
                <div class="s-btn" style="background:#af52de" onclick="tg.openLink('https://otieu.com/4/10315373')"><i class="fas fa-play-circle"></i></div>
                <div class="s-btn" style="background:#ff2d55" onclick="copyText('https://otieu.com/4/10315373')"><i class="fas fa-clone"></i></div>
            </div>
            <div style="font-size: 10px; text-align: right;">User:<br><span id="uNameDisp" style="color:var(--neon); font-weight:bold;">...</span></div>
        </div>

        <div class="notice-container">
            <marquee scrollamount="5">üì¢üë©‚Äçüíªüè¶üíµ ‡¶Ü‡¶∏‡¶∏‡¶æ‡¶≤‡¶æ‡¶Æ‡ßÅ ‡¶Ü‡¶≤‡¶æ‡¶á‡¶ï‡ßÅ‡¶Æ ‡¶Ü‡¶∂‡¶æ ‡¶ï‡¶∞‡¶ø ‡¶∏‡¶¨‡¶æ‡¶á ‡¶≠‡¶æ‡¶≤‡ßã ‡¶Ü‡¶õ‡ßá‡¶® ‡¶∏‡¶¨‡¶æ‡¶á ‡¶Æ‡¶®‡¶Ø‡ßã‡¶ó ‡¶¶‡¶ø‡ßü‡ßá ‡¶∂‡ßÅ‡¶®‡¶¨‡ßá‡¶® ‡¶∏‡¶¨‡¶æ‡¶á ‡¶¶‡ßã‡¶á‡¶®‡¶ø‡¶ï Adstar ‡¶Ü‡¶∞ Monetag ‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡¶¨‡ßá‡¶® ‡¶ï‡¶æ‡¶∞‡¶® ‡¶è‡¶á ‡¶∏‡¶æ‡¶á‡¶ü‡¶ü‡¶ø‡¶§‡ßá ‡¶è‡¶ñ‡¶® ‡¶á‡¶®‡¶ï‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶â‡¶™‡¶æ‡ßü ‡¶π‡¶≤‡ßã Monetag ‡¶Ü‡¶∞ Adstar ‡¶è‡¶á ‡ß® ‡¶ü‡¶ø ‡¶§‡ßã ‡¶∏‡¶¨‡¶æ‡¶á ‡¶¨‡ßá‡¶∂‡¶ø ‡¶¨‡ßá‡¶∂‡¶ø ‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡¶¨‡ßá‡¶® ‡¶Ö‡¶®‡ßç‡¶Ø ‡¶ï‡ßá ‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßá‡¶® ‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶∂‡ßá‡ßü‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßá ‡¶è‡¶∞ ‡¶™‡¶∞ ‡¶Ü‡¶∞ ‡¶¨‡¶æ‡¶ï‡¶ø ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ ‡¶ó‡ßÅ‡¶≤‡ßã‡¶ì ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶π‡ßü‡ßá ‡¶Ø‡¶æ‡¶¨‡ßá ‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶¶‡¶ø‡¶®‡ßá‡¶∞ ‡¶≠‡¶ø‡¶§‡¶∞‡ßá ‡¶á‡¶®‡¶∂‡¶æ‡¶Ü‡¶≤‡ßç‡¶≤‡¶æ‡¶π ‡¶¶‡ßã‡¶á‡¶®‡¶ø‡¶ï ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶ï‡¶∞‡ßá‡¶® ‡¶è‡¶¨‡¶Ç ‡¶™‡ßá‡¶Æ‡¶ø‡¶®‡ßç‡¶ü ‡¶™‡¶æ‡¶® ‡¶∏‡¶¨‡¶æ‡¶á ‡¶¶‡ßã‡¶á‡¶®‡¶ø‡¶ï ‡ß©‡ß¶ ‡¶ü‡¶ø ‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡ßá‡¶® ‡¶â‡¶™‡¶∞‡ßá ‡¶è‡¶° ‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£ ‡¶Æ‡¶æ‡¶®‡ßÅ‡¶∑‡ßá‡¶∞ ‡¶ï‡¶æ‡¶õ‡ßá ‡¶∂‡ßá‡ßü‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßá‡¶® ‡¶è‡¶§‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶¶‡ßá‡¶∞ ‡¶á‡¶®‡¶ï‡¶æ‡¶Æ ‡¶¨‡¶æ‡¶∞‡¶¨‡ßá ‡¶Ü‡¶∞ ‡¶∞‡ßá‡¶´‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßá‡¶® ‡¶¨‡ßá‡¶∂‡¶ø ‡¶¨‡ßá‡¶∂‡¶ø ‡¶§‡¶æ‡¶π‡¶≤‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞‡¶æ ‡¶è‡¶ï‡¶ü‡¶ø ‡¶≠‡¶æ‡¶≤‡ßã ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶® ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶á‡¶®‡¶ï‡¶æ‡¶Æ ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶¨‡ßá‡¶® üíØüíØüíµüíµ ‡¶á‡¶®‡¶∂‡¶æ‡¶Ü‡¶≤‡ßç‡¶≤‡¶æ‡¶π</marquee>
        </div>

        <div class="orb">
            <span style="font-size:28px; font-weight:bold" id="pDisp">0</span>
            <small style="letter-spacing: 2px;">POINTS</small>
        </div>

        <div class="stats">
            <div class="s-box">Monetag Ad: <br><strong id="mCount" style="color:var(--neon)">0/20</strong></div>
            <div class="s-box">Adstar Ad: <br><strong id="aCount" style="color:var(--neon)">0/10</strong></div>
            <div class="s-box">Referrals: <br><strong id="rCount" style="color:var(--neon)">0</strong></div>
            <div class="s-box">Total Viewed: <br><strong id="tCount" style="color:var(--neon)">0</strong></div>
        </div>

        <div class="btn-grid">
            <button class="btn" id="mBtn" onclick="watchM()"><i class="fas fa-video"></i><span id="mText">MONETAG AD</span></button>
            <button class="btn" id="aBtn" onclick="watchA()"><i class="fas fa-star"></i><span id="aText">ADSTAR AD</span></button>
            <button class="btn" onclick="openWall('ayet')"><i class="fas fa-gamepad"></i>AYET STUDIOS</button>
            <button class="btn" onclick="openWall('cpx')"><i class="fas fa-poll-h"></i>CPX SURVEY</button>
            <button class="btn" onclick="openWall('bitlabs')"><i class="fas fa-flask"></i>BITLABS</button>
            <button class="btn" onclick="openWall('adgem')"><i class="fas fa-gem"></i>ADGEM</button>
            <button class="btn" onclick="openWModal()" style="border-color:#28cd41; color:#28cd41;"><i class="fas fa-wallet"></i>WITHDRAW</button>
            <button class="btn" onclick="doRefer()" style="border-color:#ff9500; color:#ff9500;"><i class="fas fa-users"></i>REFER LINK</button>
        </div>
        <button class="btn" style="width:100%; margin-top:15px; background:rgba(255, 45, 85, 0.15); border-color:#ff2d55;" onclick="tg.close()">EXIT APP</button>
    </div>

    <div id="wModal">
        <h3 style="text-align:center; color:var(--neon); margin-top:0;">Cash Out üí∞</h3>
        <input type="number" id="wAmount" placeholder="Points (Min 2000)" value="2000">
        <select id="wMethod">
            <option value="Bikash">Bikash</option>
            <option value="Nagad">Nagad</option>
            <option value="Rocket">Rocket</option>
        </select>
        <input type="number" id="wPhone" placeholder="Your 11 Digit Number">
        <button class="btn" style="width:100%; background:var(--neon); color:#000; border:none; margin-bottom:8px;" onclick="submitWithdraw()">SUBMIT REQUEST</button>
        <button class="btn" style="width:100%; background:#333; border:none;" onclick="closeWModal()">CANCEL</button>
    </div>

    <div id="wallSection" class="section">
        <button class="btn" style="width:100%; background:#ff2d55;" onclick="closeWall()">BACK TO HOME</button>
        <iframe id="wall-iframe" frameborder="0"></iframe>
    </div>
    <div id="toast"></div>

    <script>
        const BACKEND = "https://monetagads4241r.onrender.com";
        const tg = window.Telegram.WebApp;
        tg.expand();
        const uid = String(tg.initDataUnsafe?.user?.id || "test_user");
        document.getElementById('uNameDisp').innerText = (tg.initDataUnsafe?.user?.first_name || "USER").toUpperCase();

        const firebaseConfig = { 
            apiKey: "AIzaSyBHgVkLJu7ROlQYcvx7sxDJjEJymZkXEdR", 
            projectId: "monetas-ads-4241", 
            appId: "1:482009819786:web:8606ae48b666bfd9a1db73" 
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // ‡¶∞‡¶ø‡ßü‡ßá‡¶≤-‡¶ü‡¶æ‡¶á‡¶Æ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ö‡ßá‡¶ï
        db.collection('users').doc(uid).onSnapshot(doc => {
            if(doc.exists) {
                const d = doc.data();
                document.getElementById('pDisp').innerText = d.coins || 0;
                document.getElementById('rCount').innerText = d.referrals || 0;
                document.getElementById('tCount').innerText = d.totalAdsWatched || 0;
                
                const today = new Date(new Date().getTime() + (6 * 60 * 60 * 1000)).toISOString().slice(0, 10);
                const mC = d.lastAdDate === today ? (d.adsToday || 0) : 0;
                const aC = d.lastAdstarDate === today ? (d.adstarToday || 0) : 0;
                
                document.getElementById('mCount').innerText = `${mC}/20`;
                document.getElementById('aCount').innerText = `${aC}/10`;
                
                updateTimerUI(d.lastAdTime, 300, 'mBtn', 'mText', 'MONETAG AD', mC, 20);
                updateTimerUI(d.lastAdstarTime, 600, 'aBtn', 'aText', 'ADSTAR AD', aC, 10);
            }
        });

        function updateTimerUI(lastT, duration, btnId, txtId, label, count, limit) {
            const btn = document.getElementById(btnId), txt = document.getElementById(txtId);
            if(count >= limit) { btn.classList.add('btn-disabled'); txt.innerText = "LIMIT FULL"; return; }
            if(!lastT) return;
            
            const lastTime = lastT.toDate ? lastT.toDate().getTime() : lastT;
            const diff = (Date.now() - lastTime) / 1000;
            
            if(diff < duration) {
                btn.classList.add('btn-disabled');
                let rem = Math.ceil(duration - diff);
                const timer = setInterval(() => {
                    rem--;
                    if(rem <= 0) { clearInterval(timer); btn.classList.remove('btn-disabled'); txt.innerText = label; }
                    else txt.innerText = `Wait ${rem}s`;
                }, 1000);
            } else { btn.classList.remove('btn-disabled'); txt.innerText = label; }
        }

        function watchM() { if(typeof show_10318378 === 'function') { show_10318378({ymid: uid}).then(() => claim('claim-reward')); } }
        function watchA() { tg.openLink('https://www.effectivegatecpm.com/e0xpfuhe?key=fb81fa455f0ff2d6a8fa09ce5d18dd57'); setTimeout(() => claim('claim-adstar'), 15000); }
        
        async function claim(ep) {
            try {
                const r = await fetch(`${BACKEND}/api/${ep}`, { method: 'POST', headers: {'x-telegram-init-data': tg.initData} });
                const d = await r.json(); showToast(d.message);
            } catch(e) { showToast("Server Error!"); }
        }

        async function submitWithdraw() {
            const amount = parseInt(document.getElementById('wAmount').value);
            const phone = document.getElementById('wPhone').value;
            if(amount < 2000) return showToast("Minimum 2000 Points!");
            if(phone.length !== 11) return showToast("Invalid Phone Number!");
            const res = await fetch(`${BACKEND}/api/withdraw`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json', 'x-telegram-init-data': tg.initData },
                body: JSON.stringify({ amount, method: document.getElementById('wMethod').value, phone })
            });
            const d = await res.json();
            showToast(d.message); if(d.ok) closeWModal();
        }

        function openWall(t) {
            document.getElementById('wallSection').style.display = 'block';
            let url = t==='ayet' ? `https://support.ayet.io/offers?externalIdentifier=${uid}&placementId=21472` : 
                      t==='cpx' ? `https://offers.cpx-research.com/index.php?app_id=30520&ext_user_id=${uid}&secure_hash=${md5(uid + "-0UO1OjWFA1DzWsmbSlsNL6zgRJ0ovYed")}` :
                      t==='bitlabs' ? `https://web.bitlabs.ai/?token=246506f4-d3bf-4b41-8cfc-9aa09ee7b8c9&uid=${uid}` : `https://api.adgem.com/v1/wall?appid=31665&playerid=${uid}`;
            document.getElementById('wall-iframe').src = url;
        }
        function closeWall() { document.getElementById('wallSection').style.display = 'none'; document.getElementById('wall-iframe').src = ""; }
        function openWModal() { document.getElementById('wModal').style.display = 'block'; }
        function closeWModal() { document.getElementById('wModal').style.display = 'none'; }
        function doRefer() { navigator.clipboard.writeText(`https://t.me/realldoler87ok_bot?start=${uid}`); showToast("Refer Link Copied!"); }
        function showToast(m) { const t = document.getElementById('toast'); t.innerText = m; t.style.visibility = 'visible'; setTimeout(() => t.style.visibility = 'hidden', 3000); }
        function copyText(txt) { navigator.clipboard.writeText(txt); showToast("Link Copied!"); }

        fetch(`${BACKEND}/api/sync`, { method: 'POST', headers: {'x-telegram-init-data': tg.initData, 'x-start-param': tg.initDataUnsafe.start_param || ''} });
    </script>
</body>
    </html>
